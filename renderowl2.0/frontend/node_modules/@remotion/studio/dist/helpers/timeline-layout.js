"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTimelineLayerHeight = exports.getExpandedTrackHeight = exports.getSchemaFields = exports.UNSUPPORTED_FIELD_ROW_HEIGHT = exports.SCHEMA_FIELD_ROW_HEIGHT = exports.TIMELINE_TRACK_EXPANDED_HEIGHT = exports.TIMELINE_ITEM_BORDER_BOTTOM = exports.TIMELINE_BORDER = exports.TIMELINE_PADDING = void 0;
const zod_schema_type_1 = require("../components/RenderModal/SchemaEditor/zod-schema-type");
exports.TIMELINE_PADDING = 16;
exports.TIMELINE_BORDER = 1;
exports.TIMELINE_ITEM_BORDER_BOTTOM = 1;
exports.TIMELINE_TRACK_EXPANDED_HEIGHT = 100;
exports.SCHEMA_FIELD_ROW_HEIGHT = 26;
exports.UNSUPPORTED_FIELD_ROW_HEIGHT = 26;
const SUPPORTED_SCHEMA_TYPES = new Set([
    'number',
    'string',
    'boolean',
    'enum',
    'date',
    'array',
    'object',
    'optional',
    'nullable',
    'default',
]);
const getSchemaFields = (controls) => {
    if (!controls) {
        return null;
    }
    const shape = (0, zod_schema_type_1.getObjectShape)(controls.schema);
    return Object.entries(shape).map(([key, fieldSchema]) => {
        const typeName = (0, zod_schema_type_1.getZodSchemaType)(fieldSchema);
        const supported = SUPPORTED_SCHEMA_TYPES.has(typeName);
        return {
            key,
            typeName,
            supported,
            rowHeight: supported
                ? exports.SCHEMA_FIELD_ROW_HEIGHT
                : exports.UNSUPPORTED_FIELD_ROW_HEIGHT,
            currentValue: controls.currentValue[key],
            fieldSchema,
        };
    });
};
exports.getSchemaFields = getSchemaFields;
const getExpandedTrackHeight = (controls) => {
    const fields = (0, exports.getSchemaFields)(controls);
    if (!fields || fields.length === 0) {
        return exports.TIMELINE_TRACK_EXPANDED_HEIGHT;
    }
    return fields.reduce((sum, f) => sum + f.rowHeight, 0);
};
exports.getExpandedTrackHeight = getExpandedTrackHeight;
const getTimelineLayerHeight = (type) => {
    if (type === 'video') {
        return 50;
    }
    return 25;
};
exports.getTimelineLayerHeight = getTimelineLayerHeight;
